<%- include('./partials/head') %>
<!-- inline css -->
<style>
.case-study-row.flex-container {
    display: flex;
    justify-content: space-between;
    align-items: center; 
}

.case-study-row .cell {
    flex: 1; 
    margin: 5px; 
}

.custom-modal {
     max-width: 1000px;
     max-height: 800px;
 }
 .sub-title-text{
     font-size: 15px;
     font-weight:500;
 }

</style>

<!-- Navbar section -->
<%- include('./partials/header') %>
<!-- This is left sidebar  -->
<%- include('./partials/left-sidebar') %>
<!-- This is right side section -->
<main class="main" id="mainContent">
                <div class="base-section coustom-section mt-5 p-5">
                    <!--DASHBOARD CONTENT START-->
                    <div class="breadcrumbs-container">
                        <ul class="breadcrumb">
                            <li><a href="../html/dashboard.html">ADMIN</a></li>
                            <li><a href="">Case-study</a></li>
                        </ul>
                    </div>
                    <div class="errorHtml"></div>
                    <div class="card table-card">
                        <div
                            class="card-header table-card-header text-uppercase d-flex align-items-center justify-content-between">
                            <div>
                                <h5>PROGRAM LIST</h5>
                            </div>
                            <div class="me-2">
                                <a class="btn btn-danger" href="/admin/programs/download"><i
                                        class="fas fa-download"></i>
                                    Download </a>
                                <button type="button" class="btn btn-primary " data-toggle="modal"
                                    data-target="#case-study-modal">
                                    <i id="modal-form" class="fas fa-plus plus"></i></button>
                                </button>
                            </div>
                        </div>
                        <div class="card-body table-responsive">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <label>Show Entries</label>
                                    <select class="form-select" id="changeEntry">
                                        <option value="10">10</option>
                                        <option value="25">25</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                        <option value="150">150</option>
                                        <option value="200">200</option>
                                        <option value="250">250</option>
                                        <option value="300">300</option>
                                        <option value="350">350</option>
                                        <option value="400">400</option>
                                        <option value="500">500</option>
                                        <option value="800">800</option>
                                        <option value="1000">1000</option>
                                    </select>
                                </div>
                                <div>
                                    <div class="table-searchbar-container"><button type="button"><i
                                                class="fas fa-search"></i>
                                        </button><input type="search" id="searchkeyword" placeholder="Enter keywords"
                                            class="table-searchbar">
                                    </div>
                                </div>
                            </div>
                            <table class=" table" id="case-studies-data-list">
                                <thead>
                                    <th class="cell">#</th>
                                    <th class="cell">Author First Name</th>
                                    <th class="cell">Author Last Name</th>
                                    <th class="cell">Title of Case Study</th>
                                    <th class="cell">Edition</th>
                                    <th class="cell">Publisher Name</th>
                                    <th class="cell">Volume Number</th>
                                    <th class="cell">Publication Year</th>
                                    <th class="cell">Action</th>
                                </thead>
                              <% caseStudiesData.forEach(function(caseStudy) { %>
                                        <tr scope="row" data-case-id="<%- caseStudy.id %>" data-page-number="<%- caseStudy.page_number %>"
                                            data-url_of_case_study="<%- caseStudy.url_of_case_study %>" data-number_of_nmims_authors="<%- caseStudy.number_of_nmims_authors %>"
                                            data-nmims-authors="<%- caseStudy.nmims_authors %>" data-nmims_campus_authors="<%- caseStudy.nmims_campus_authors %>"
                                            data-nmims_school_authors="<%- caseStudy.nmims_school_authors %>">
                                            <td class="cell " data-case-id="<%- caseStudy.id %>"> <%- caseStudy.id %> </td>
                                            <td class="cell author-first-name"> <%- caseStudy.author_first_name %> </td>
                                            <td class="cell author-last-name"> <%- caseStudy.author_last_name %> </td>
                                            <td class="cell title-of-case-study">  <%- caseStudy.title_of_case_study %> </td>
                                            <td class="cell edition"><%- caseStudy.edition %> </td>
                                            <td class="cell publisher-name "> <%- caseStudy.publisher_name %> </td>
                                            <td class="cell volume-number "> <%- caseStudy.volume_number %> </td>
                                            <td class="cell publication-year"> <%- caseStudy.publication_year %> </td>
                                            <td class="cell ">
                                                <a class="view" data-case-id="<%- caseStudy.id %>"><i class="fa-solid fa-eye view"
                                                    data-case-id="<%- caseStudy.id %>"></i></a>
                                                <a class="edit" data-case-id="<%- caseStudy.id %>"><i class="fa fa-edit edit"
                                                    data-case-id="<%- caseStudy.id %>"></i></a>
                                                <a class="delete" data-case-id="<%- caseStudy.id %>"><i class="fa-solid fa-trash delete"
                                                    data-case-id="<%- caseStudy.id %>"></i></a>
                                            </td>
                                        </tr>
                                <% }); %>
                        </table>    
                            <div class="d-flex justify-content-between">
                                <div>
                                    <p>Total entries:1
                                    </p>
                                </div>
                                <div>
                                    <p id="pagination" class="pagination-search"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--Import Modal -->
    <div class="modal fade" id="open-program-modal" tabindex="-1" aria-labelledby="open-program-modal"
                        aria-hidden="true">
    </div>
    <!-- EDIT PROGRAM AND UPDATE -->
    <div class="modal fade" id="edit-program-modal" tabindex="-1" aria-labelledby="editModalLabel"
                        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">Update Program</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div id="errorHtml"></div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="exampleInputEmail1" class="form-label">Program Name</label>
                        <input type="text" class="form-control" id="program_name" name="program_name">
                        <input type="hidden" class="form-control" id="hidden_id" name="hidden_id">
                    </div>
                    <div class="mb-3">
                        <label for="exampleInputPassword1" class="form-label">Program Type</label>
                        <select class="form-control" name="program_type_lid" id="program_type_lid">
                            <option value="1">Full Time</option>
                            <option value="2">Part Time</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="abbr" class="form-label">Program Abbr</label>
                        <input type="text" class="form-control" id="abbr" name="abbr">
                    </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary updateProgram">Update</button>
                    </div>
                </div>
            </div>
        </div>
</main>
<!-- Modal  form -->
<div class="modal fade " id="case-study-modal" tabindex="-1" role="dialog" aria-labelledby="case-study"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-lg modal-fullscreen p-5" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="case-study">case study </h5>
                <div class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"><i class="fas fa-times fa-2x"></i></span>
                </div>
            </div>
            <div class="modal-body">
                <div class="row">
                    <!-- author's first name -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <div class="form-group col">
                            <label for="firstname" class="form-label  fw-bold">Author's first name</label>
                            <input type="text" name="author-first-name" id="author-first-name" class="form-control"
                                placeholder="First name">
                        </div>
                    </div>

                    <!-- Author's last name -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <div class="form-group col">
                            <label for="lastname" class="form-label  fw-bold">Author's last name</label>
                            <input type="text" name="lname" id="author-last-name" class="form-control" placeholder="Last name">
                        </div>
                    </div>
                    <!-- Title of case study -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="caseStudy" class="form-label fw-bold">Title of case study</label>
                        <input type="text" name="case-study" id="title-of-case-study" class="form-control"
                            placeholder="Title of case study">
                    </div>
                    <!-- Edition -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="edition" class="form-label fw-bold">Edition</label>
                        <input type="text" name="case-study" id="edition" class="form-control" placeholder="Optional">
                    </div>
                    <!-- Volume number -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="Volume" class="form-label fw-bold">Volume number</label>
                        <input type="text" name="vol" id="volume-number" class="form-control" placeholder="Optional">
                    </div>
                    <!-- Publisher Name -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="publisherName" class="form-label fw-bold">Publisher Name</label>
                        <input type="text" name="vol" id="publisher-name" class="form-control"
                            placeholder="Pulisher name">
                    </div>

                    <!-- Publication Year -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="publicationYear" class="form-label fw-bold">Publication Year</label>
                        <input type="text" name="Year" id="publication-year" class="form-control"
                            placeholder="Publication Year">
                    </div>

                    <!-- Page numbers -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="pageNumber" class="form-label fw-bold">Page Number</label>
                        <input type="number" name="page-number" id="page-number" class="form-control"
                            placeholder="Page Number">
                    </div>
                    <!-- URL of the Case Study -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="caseStudy" class="form-label fw-bold">URL of the Case Study</label>
                        <input type="url" name="case-study" id="url-of-case-study" class="form-control"
                            placeholder="URL">
                    </div>
                    <!-- No. of NMIMS Authors -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="NMIMSAuthors" class="form-label fw-bold ">No. of NMIMS Authors</label>
                        <input type="text" name="nmims-authors" id="number-of-nmims-authors"
                            placeholder="No. of NMIMS Authors" class="form-control " />
                    </div>
                    <!-- Name of NMIMS Authors -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="nameOfAuthors" class="form-label fw-bold ">Name of NMIMS Authors</label>
                        <input type="text" name="web-link" id="nmims-authors" placeholder="Name of NMIMS Authors"
                            class="form-control " />
                    </div>
                    <!-- NMIMS Campus - Author -->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="campusAuthors" class="form-label fw-bold ">NMIMS Campus Author</label>
                        <input type="url" name="web-link" id="nmims-campus-authors" placeholder="NMIMS Campus Author"
                            class="form-control " />
                    </div>
                    <!--NMIMS School - Author-->
                    <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                        <label for="campusAuthors" class="form-label fw-bold ">NMIMS School Author</label>
                        <input type="url" name="web-link" id="nmims-school-authors" placeholder="NMIMS School Author"
                            class="form-control " />
                    </div>
                </div>
            </div>
            <!-- footer button -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary d-none" id="submitBtn">Submit</button>
                <button type="button" class="btn btn-primary d-none" id="updateBtn">update</button>
            </div>
        </div>
    </div>
</div>
<!-- case-view-modal -->
<div class="modal fade" id="case-view-modal" tabindex="-1" role="dialog" aria-labelledby="case-view-modal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered custom-modal " role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title text-center" id="exampleModalLongTitle">CASE STUDY </h5>
          <div type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true"><i class="fas fa-times fa"></i></span>
          </div>
        </div>
        <div class="modal-body">
            <div class="row">
                <!-- author's first name -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">AUTHOR'S FIRST NAME :</div>
                        <label id="view-first-name"></label>
                    </div>
                </div>

                <!-- Author's last name -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">AUTHOR'S LAST NAME :</div>
                        <label id="view-last-name"></label>
                    </div>
                </div>
                <!-- Title of case study -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">TITLE OF CAES STUDY :</div>
                        <label id="view-title-of-case-study"></label>
                    </div>
                </div>

                <!-- Edition -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">EDITION :</div>
                        <label id="view-edition"></label>
                    </div>
                </div>
                <!-- Volume number -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">VOLUME NUMBER :</div>
                        <label id="view-volume-number"></label>
                    </div>
                </div>

                <!-- Publisher Name -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">PUBLISHER NAME :</div>
                        <label id="view-publisher-name"></label>
                    </div>
                </div>

                <!-- Publication Year -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">PUBLICATION YEAR :</div>
                        <label id="view-publication-year"></label>
                    </div>
                </div>
                <!-- Publication Year -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">PUBLISHER CATEGORY :</div>
                        <label id="view-publisher-category"></label>
                    </div>
                </div>
                <!-- Publication Year -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">PAGE NUMBER :</div>
                        <label id="view-page-number"></label>
                    </div>
                </div>
                <!-- Publication Year -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">URL OF THE CASE STUDY  :</div>
                        <label id="view-url-of-case-study"></label>
                    </div>
                </div>
                <!-- Publication Year -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text"> NO. OF NMIMS AUTHORS  :</div>
                        <label id="view-no-of-nmims-authors"></label>
                    </div>
                </div>
                <!-- Publication Year -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text"> NAME OF NMIMS AUTHORS :</div>
                        <label id="view-nmims-authors"></label>
                    </div>
                </div>
                <!-- Publication Year -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">NMIMS CAMPUS AUTHOR:</div>
                        <label id="view-nmims-campus-authors"></label>
                    </div>
                </div>
                <!-- Publication Year -->
                <div class="col-lg-4 col-md-6  col-sm-12 p-3">
                    <div class="box">
                        <div class="task-sub-title sub-title-text">NMIMS  SCHOOL AUTHOR :</div>
                        <label id="view-nmims-school-authors"></label>
                    </div>
                </div>
        </div> 
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

<!-- inline javascript -->
<script>
    const caseStudiesDataList = document.getElementById('case-studies-data-list');
    const submitBtn = document.getElementById('submitBtn');
    const updateBtn = document.getElementById('updateBtn');
    const openMadalFormBtn = document.getElementById('modal-form');
    openMadalFormBtn.addEventListener('click' , async function(event){
        if(event.target.classList.contains('plus')){
            // for button visualization
            submitBtn.classList.remove('d-none');
            updateBtn.classList.add('d-none');
            document.getElementById('author-first-name').value = '';
            document.getElementById('author-last-name').value = '';
            document.getElementById('title-of-case-study').value = '';
            document.getElementById('edition').value = '';
            document.getElementById('volume-number').value = '';
            document.getElementById('publisher-name').value = '';
            document.getElementById('publication-year').value = '';
            document.getElementById('page-number').value = '';
            document.getElementById('url-of-case-study').value = '';
            document.getElementById('number-of-nmims-authors').value = '';
            document.getElementById('nmims-authors').value = '';
            document.getElementById('nmims-campus-authors').value = '';
            document.getElementById('nmims-school-authors').value = '';
        }
    })
    let caseStudyId , rowToBeUpdate;

    submitBtn.addEventListener('click' , function(){
        console.log('clickeddd');
        const caseStudyData = {};
        caseStudyData. author_first_name = document.getElementById('author-first-name').value;
        caseStudyData.author_last_name = document.getElementById('author-last-name').value;
        caseStudyData.title_of_case_study = document.getElementById('title-of-case-study').value;
        caseStudyData.edition = document.getElementById('edition').value;
        caseStudyData.volume_number = document.getElementById('volume-number').value;
        caseStudyData.publisher_name = document.getElementById('publisher-name').value;
        caseStudyData.publication_year = document.getElementById('publication-year').value;
        caseStudyData.page_number = document.getElementById('page-number').value;
        caseStudyData.url_of_case_study = document.getElementById('url-of-case-study').value;
        caseStudyData.number_of_nmims_authors = document.getElementById('number-of-nmims-authors').value;
        caseStudyData.nmims_authors = document.getElementById('nmims-authors').value;
        caseStudyData.nmims_campus_authors = document.getElementById('nmims-campus-authors').value;
        caseStudyData.nmims_school_authors = document.getElementById('nmims-school-authors').value;
        console.log('caseStudyData.nmims_school_authors' , caseStudyData.nmims_school_authors)

        const payload = {
            caseStudyData : caseStudyData
        }

        fetch('/research/case-study/insert' , {
            method : 'POST',
            headers : {
                'content-type' : 'application/json'
            },
            body : JSON.stringify(payload)
        })
        .then((result) => {
            return result.json();
        })
        .then ((data) => {
            console.log('data ==>>' , data);
            if(data.status === 'done'){
                caseStudyId = data.caseStudyId;
                console.log('caseStudyId', caseStudyId);
                const newCaseStudy = document.createElement('tr');
                newCaseStudy.setAttribute('data-page-number', caseStudyData.page_number);
                newCaseStudy.setAttribute('data-url_of_case_study', caseStudyData.url_of_case_study);
                newCaseStudy.setAttribute('data-number_of_nmims_authors', caseStudyData.number_of_nmims_authors);
                newCaseStudy.setAttribute('data-nmims-authors', caseStudyData.nmims_authors);
                newCaseStudy.setAttribute('data-nmims_campus_authors', caseStudyData.nmims_campus_authors);
                newCaseStudy.setAttribute('data-nmims_school_authors', caseStudyData.nmims_school_authors);
                newCaseStudy.innerHTML = `
                        <td class="cell">${caseStudyId}</td>
                        <td class="cell author-first-name">${caseStudyData.author_first_name}</td>
                        <td class="cell author-last-name">${caseStudyData.author_last_name}</td>
                        <td class="cell title-of-case-study">${caseStudyData.title_of_case_study}</td>
                        <td class="cell edition">${caseStudyData.edition}</td>
                        <td class="cell volume-number">${caseStudyData.volume_number}</td>
                        <td class="cell publisher-name">${caseStudyData.publisher_name}</td>
                        <td class="cell publication-year">${caseStudyData.publication_year}</td>
                        <td class="cell actions">
                            <a class="view" data-case-id="${caseStudyId}"><i data-case-id="${caseStudyId}" class="fa-solid fa-eye view"></i></a>
                            <a class="edit" data-case-id="${caseStudyId}"><i data-case-id="${caseStudyId}" class="fa fa-edit edit"></i></a>
                            <a class="delete" data-case-id="${caseStudyId}"><i data-case-id="${caseStudyId}" class="fa-solid fa-trash delete"></i></a>
                        </td> `;
                        
                        caseStudiesDataList.appendChild(newCaseStudy);
                        $('#case-study-modal').modal('hide');
                        alert('data saved successfully');
            }
        })
        .catch((error) => {
            console.log('ERROR' , error);
        })


    });

    caseStudiesDataList.addEventListener('click' , async function(event) {
        if(event.target.classList.contains('view')){
            caseStudyId = event.target.getAttribute('data-case-id');
            const viewauthor_first_name = document.getElementById('view-first-name');
            const viewauthor_last_name = document.getElementById('view-last-name');
            const viewtitle_of_case_study =document.getElementById('view-title-of-case-study');
            const viewedition = document.getElementById('view-edition');
            const viewvolume_number = document.getElementById('view-volume-number');
            const viewpublisher_name =document.getElementById('view-publisher-name');
            const viewpublisher_category = document.getElementById('view-publisher-category');
            const viewpublication_year = document.getElementById('view-publication-year');
            const viewpage_number = document.getElementById('view-page-number');
            const viewurl_of_case_study = document.getElementById('view-url-of-case-study');
            const viewnumber_of_nmims_authors = document.getElementById('view-no-of-nmims-authors');
            const viewnmims_authors = document.getElementById('view-nmims-authors');
            const viewnmims_campus_authors = document.getElementById('view-nmims-campus-authors');
            const viewnmims_school_authors = document.getElementById('view-nmims-school-authors');

            fetch('/research/case-study/view' , {
                method : 'POST',
                headers : {
                    'content-type' : 'application/json'
                },
                body : JSON.stringify({
                    caseStudyId : caseStudyId
                })
            })
            .then((result) => {
                return result.json();
            })
            .then((data) => {
                console.log('data ==>>', data);
                viewauthor_first_name.innerText = data[0].author_first_name;
                console.log('first-name' , data[0].author_first_name );
                viewauthor_last_name.innerText = data[0].author_last_name;
                viewtitle_of_case_study.innerText = data[0].title_of_case_study;
                viewedition.innerText = data[0].edition;
                viewvolume_number.innerText = data[0].volume_number;
                viewpublisher_name.innerText = data[0].publisher_name;
                viewpublication_year.innerText = data[0].publication_year;
                viewpage_number.innerText = data[0].page_number;
                viewurl_of_case_study.innerText = data[0].url_of_case_study;
                viewnumber_of_nmims_authors.innerText = data[0].number_of_nmims_authors;
                viewnmims_authors.innerText = data[0].nmims_authors;
                viewnmims_campus_authors.innerText = data[0].nmims_campus_authors;
                viewnmims_school_authors.innerText = data[0].nmims_school_authors;
                
                
            })
            .catch((error) => {
                console.log('ERROR :', error);
            })

            $('#case-view-modal').modal('show');
        }

        // for deleting
        if(event.target.classList.contains('delete')){
            console.log('clickkeddd');
            caseStudyId = event.target.getAttribute('data-case-id');
            const rowToBeDelete = event.target.parentElement.parentElement.parentElement;
            console.log('==>>>', rowToBeDelete)
            console.log('ID', caseStudyId);
            fetch('/research/case-study/delete' , {
                method : 'POST',
                headers : {
                    'content-type' : 'application/json'
                },
                body : JSON.stringify({
                    caseStudyId : caseStudyId
                })
            })
            .then((result) => {
                return result.json();
            })
            .then((data) => {
                if(data.status === 'done'){
                    console.log('data ==>>', data);
                    rowToBeDelete.remove();
                    
                }
            })
            .catch((error) => {
                console.log('ERROR ::', error);
            })
        }

        if(event.target.classList.contains('edit')){
            console.log('clickeddddd');
            $('#case-study-modal').modal('show');
            // button visualization
            submitBtn.classList.add('d-none');
            updateBtn.classList.remove('d-none');
            caseStudyId = event.target.getAttribute('data-case-id');
            console.log('ID For Updation' , caseStudyId);
            rowToBeUpdate = event.target.parentElement.parentElement.parentElement;
            // capturing specific data
            const page_number =  rowToBeUpdate.getAttribute('data-page-number');
            const url_of_case_study = rowToBeUpdate.getAttribute('data-url_of_case_study');
            const number_of_nmims_authors = rowToBeUpdate.getAttribute('data-number_of_nmims_authors');
            const nmims_authors = rowToBeUpdate.getAttribute('data-nmims-authors');
            console.log('data-number_of_nmims_authors ==>',nmims_authors);
            const nmims_campus_authors  = rowToBeUpdate.getAttribute('data-nmims_campus_authors');
            const nmims_school_authors = rowToBeUpdate.getAttribute('data-nmims_school_authors');
            console.log('page Number ==>>', page_number );
            const author_first_name = rowToBeUpdate.querySelector('.author-first-name');
            console.log('author_first_name ==>', author_first_name);
            const author_last_name = rowToBeUpdate.querySelector('.author-last-name');
            const title_of_case_study = rowToBeUpdate.querySelector('.title-of-case-study');
            const edition = rowToBeUpdate.querySelector('.edition');
            const volume_number = rowToBeUpdate.querySelector('.volume-number');
            const publisher_name = rowToBeUpdate.querySelector('.publisher-name');
            const publication_year = rowToBeUpdate.querySelector('.publication-year');

            // updating actual value 
            document.getElementById('author-first-name').value = author_first_name.textContent;
            console.log('===>>>>', author_first_name.textContent );
            document.getElementById('author-last-name').value = author_last_name.textContent;
            document.getElementById('title-of-case-study').value = title_of_case_study.textContent;
            document.getElementById('edition').value = edition.textContent;
            document.getElementById('volume-number').value = volume_number.textContent;
            document.getElementById('publisher-name').value = publisher_name.textContent;
            document.getElementById('publication-year').value = publication_year.textContent;
            document.getElementById('page-number').value = page_number;
            document.getElementById('url-of-case-study').value = url_of_case_study;
            document.getElementById('number-of-nmims-authors').value = number_of_nmims_authors;
            document.getElementById('nmims-authors').value = nmims_authors;
            document.getElementById('nmims-campus-authors').value = nmims_campus_authors;
            document.getElementById('nmims-school-authors').value = nmims_school_authors ;
        }
    })
    updateBtn.addEventListener('click' , function(){
        console.log('data is updated');
        const updatedName = document.getElementById('author-first-name').value;
        const updatedPage = document.getElementById('page-number').value;
        const updateLastName = document.getElementById('author-last-name').value;
        const updatedEdition = document.getElementById('edition').value;
        const updatedVolume = document.getElementById('volume-number').value;
        const updatedPublisher = document.getElementById('publisher-name').value;
        const updatedPublicationYear = document.getElementById('publication-year').value;
        const updatedUrl = document.getElementById('url-of-case-study').value;
        const updatedNmimsAuthors = document.getElementById('nmims-authors').value;
        const updatedNumberOfNmimsAuthor = document.getElementById('number-of-nmims-authors').value;
        const updatedCampus = document.getElementById('nmims-campus-authors').value;
        const updatedschool = document.getElementById('nmims-school-authors').value;
        const updatedtitle = document.getElementById('title-of-case-study').value;
        console.log(' updatedPageNumber ===>>', updatedPage);

        const updatedCaseStudies = {};
        updatedCaseStudies.caseStudyId = caseStudyId;
        updatedCaseStudies.author_first_name = updatedName;
        updatedCaseStudies.author_last_name = updateLastName;
        updatedCaseStudies.page_number = updatedPage;
        updatedCaseStudies.edition = updatedEdition;
        updatedCaseStudies.volume_number = updatedVolume;
        updatedCaseStudies.publication_year =updatedPublicationYear;
        updatedCaseStudies.publisher_name = updatedPublisher;
        updatedCaseStudies.url_of_case_study = updatedUrl;
        updatedCaseStudies.nmims_authors = updatedNmimsAuthors;
        updatedCaseStudies.number_of_nmims_authors = updatedNumberOfNmimsAuthor;
        updatedCaseStudies.nmims_campus_authors = updatedCampus;
        updatedCaseStudies.nmims_school_authors = updatedschool;
        updatedCaseStudies.title_of_case_study = updatedtitle;

        fetch('/research/case-study/update' , {
            method : 'POST',
            headers : {
                'content-type' : 'application/json'
            },
            body : JSON.stringify(updatedCaseStudies)
        })
        .then((result) => {
            return result.json();
        })
        .then((data) => {
            console.log('data ===>>>' , data);
            if(data.status === 'done'){
                console.log('caseID >>>', caseStudyId);
                rowToBeUpdate.querySelector('.author-first-name').innerText = updatedCaseStudies.author_first_name;
                rowToBeUpdate.querySelector('.author-last-name').innerText = updatedCaseStudies.author_last_name;
                rowToBeUpdate.querySelector('.edition').innerText = updatedCaseStudies.edition;
                rowToBeUpdate.querySelector('.volume-number').innerText = updatedCaseStudies.volume_number;
                rowToBeUpdate.querySelector('.publication-year').innerText = updatedCaseStudies.publication_year;
                rowToBeUpdate.setAttribute('data-page-number', updatedPage);
                rowToBeUpdate.setAttribute('data-url_of_case_study', updatedUrl);
                rowToBeUpdate.setAttribute('data-number_of_nmims_authors', updatedNumberOfNmimsAuthor);
                rowToBeUpdate.setAttribute('data-nmims-authors', updatedNmimsAuthors);
                rowToBeUpdate.setAttribute('data-nmims_campus_authors', updatedCampus);
                rowToBeUpdate.setAttribute('data-nmims_school_authors', updatedschool);
                console.log('page ===>', updatedPage);

                $('#case-study-modal').modal('hide');
                alert('data Updated SuccessFully');            }
        })
    })
</script>
<!-- footer section -->
<%- include('./partials/footer') %>
<%- include('./partials/footer-end') %>
           